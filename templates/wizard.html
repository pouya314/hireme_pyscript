{% extends "base.html" %}

{% block head_block %}
    {{ super() }}
    <link rel="stylesheet" href="https://pyscript.net/releases/2024.7.1/core.css">
    <script type="module" src="https://pyscript.net/releases/2024.7.1/core.js"></script>

    <!-- for splashscreen -->
    <style>
        #loading {
            outline: none;
            border: none;
            background: transparent
        }
    </style>
    <script type="module">
        const loading = document.getElementById('loading');
        addEventListener('py:ready', () => loading.close());
        loading.showModal();
    </script>
{% endblock %}


{% block content %}

        <py-config>
            packages = [
                "{{ url_for('static', filename='wheels/pydux-0.2.2-py3-none-any.whl') }}",
                "requests",
                "Jinja2",
                "toolz"
            ]

            [[fetch]]
            files = [
                "{{ url_for('static', filename='files/wizard.py') }}",
                "{{ url_for('static', filename='files/helpers.py') }}",
                "{{ url_for('static', filename='files/constants.py') }}",
                "{{ url_for('static', filename='files/actions.py') }}",
                "{{ url_for('static', filename='files/reducers.py') }}",
                "{{ url_for('static', filename='files/ui.py') }}"
            ]
        </py-config>

        <py-script>
            from static.files.wizard import submit_button_clicked
        </py-script>

        <dialog id="loading">
            <h1>Loading...</h1>
        </dialog>


        <div id="root-url" style="display: none;">{{ root_url }}</div>

        <div id="wizard-container"></div>


        {% raw %}
        <template id="wizard-template">
            {% set current_question = helpers.determine_current_question(questions) %}
            {% if current_question %}
                <form class="question">
                    <input type="hidden" name="uuid" value="{{ current_question.uuid }}">
                    <h2 name="body">{{ current_question.body }}</h2>
                    {% if current_question.question_type == 'drop_down' %}
                        <select name="provided_answer">
                            {% for option in current_question.options %}
                                <option value="{{ option }}">{{ option }}</option>
                            {% endfor %}
                        </select>
                    {% elif current_question.question_type == 'text_field' %}
                        <input type="text" name="provided_answer">
                    {% elif current_question.question_type == 'text_area' %}
                        <textarea name="provided_answer" rows="4" cols="50"></textarea>
                    {% endif %}
                    <br>
                    <button py-click="submit_button_clicked">Submit</button>
                </form>
            {% else %}
                <p>No current question to show!</p>
            {% endif %}


            {#
            <div>No of Eligibility Questions: {{ eligibility_questions|length }}</div>
            <div>No of Application Questions: {{ application_questions|length }}</div>
            #}
        </template>
        {% endraw %}

{% endblock %}
